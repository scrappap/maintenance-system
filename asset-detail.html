<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Asset Detail</title>

<style>
body{
  background:#0b1118;
  color:#cfefff;
  font-family:'Segoe UI',Arial,sans-serif;
  padding:25px;
}

.card{
  background:#121c26;
  border:1px solid #00e5ff33;
  border-radius:14px;
  padding:20px;
  margin-top:20px;
}

.btn{
  border:1px solid #00e5ff55;
  background:#111a24;
  color:#00e5ff;
  padding:6px 12px;
  border-radius:6px;
  cursor:pointer;
}

.label{
  color:#ffaa00;
  font-size:12px;
}

.value{
  margin-bottom:12px;
}
</style>
</head>
<body>

<h2>Asset Detail</h2>

<button class="btn" onclick="goBack()">Back</button>

<div id="detailBox" class="card">
Loading...
</div>

<script>

const SHEET_API_URL = "https://script.google.com/macros/s/AKfycbwAJl-cEwnDnQpeSQAruRe4eeaH-BO9PTfTW2q-JZ5sXIF7p2m0usnj2IPoBdktdf7B4A/exec";
const SESSION_KEY='pm_user_session';

// Protect page
const session = JSON.parse(localStorage.getItem(SESSION_KEY));
if(!session){
  window.location.href="maintenance-system.html";
}

const params = new URLSearchParams(window.location.search);
const assetNo = params.get("asset");

if(!assetNo){
  document.getElementById("detailBox").innerHTML="No asset selected";
}

// ðŸ”¥ CALL DETAIL READ
fetch(SHEET_API_URL + "?action=detailRead&assetNo=" + encodeURIComponent(assetNo))
.then(res=>res.json())
.then(asset=>{

  if(asset.status === "not found"){
    document.getElementById("detailBox").innerHTML="Asset detail not found";
    return;
  }

  document.getElementById("detailBox").innerHTML=`
    <div class="value"><span class="label">Asset No:</span><br>${asset.assetNo || "-"}</div>
    <div class="value"><span class="label">Bumi:</span><br>${asset.bumi || "-"}</div>
    <div class="value"><span class="label">Contact Bumi:</span><br>${asset.contactBumi || "-"}</div>
    <div class="value"><span class="label">Vendor:</span><br>${asset.vendor || "-"}</div>
    <div class="value"><span class="label">Contact Vendor:</span><br>${asset.contactVendor || "-"}</div>
    <div class="value"><span class="label">Manufacturer:</span><br>${asset.manufacturer || "-"}</div>
    <div class="value"><span class="label">Brand:</span><br>${asset.brand || "-"}</div>
    <div class="value"><span class="label">Model:</span><br>${asset.model || "-"}</div>
    <div class="value"><span class="label">Serial Number:</span><br>${asset.serialNumber || "-"}</div>
    <div class="value"><span class="label">Price:</span><br>RM ${asset.price || "-"}</div>
    <div class="value"><span class="label">LO No:</span><br>${asset.loNo || "-"}</div>
    <div class="value"><span class="label">Category:</span><br>${asset.category || "-"}</div>
    <div class="value"><span class="label">Start Date:</span><br>${asset.startDate || "-"}</div>
    <div class="value"><span class="label">End Date:</span><br>${asset.endDate || "-"}</div>
  `;

})
.catch(err=>{
  document.getElementById("detailBox").innerHTML="Connection error";
  console.error(err);
});

function goBack(){
  const params = new URLSearchParams(window.location.search);
  const year = params.get("year") || new Date().getFullYear();

  window.location.href = 
    "maintenance-system.html?open=system&year=" + year;
}

</script>

</body>

</html>



